<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RH850/F1KM-S1 è©³ç´°è¨­è¨ˆæ›¸</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #64748b;
            --accent-color: #f59e0b;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --bg-color: #ffffff;
            --bg-alt: #f8fafc;
            --border-color: #e2e8f0;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --code-bg: #1e293b;
            --code-text: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.7;
            color: var(--text-primary);
            background-color: var(--bg-color);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color) 0%, #1e40af 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        nav {
            background-color: var(--bg-alt);
            padding: 20px 40px;
            border-bottom: 2px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        nav a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        nav a:hover {
            color: #1e40af;
            text-decoration: underline;
        }

        main {
            padding: 40px;
        }

        section {
            margin-bottom: 50px;
        }

        h2 {
            color: var(--primary-color);
            font-size: 2rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--primary-color);
        }

        h3 {
            color: var(--text-primary);
            font-size: 1.5rem;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        h4 {
            color: var(--text-primary);
            font-size: 1.2rem;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        p {
            margin-bottom: 15px;
            text-align: justify;
        }

        ul, ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 8px;
        }

        code {
            background-color: #f1f5f9;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            color: #dc2626;
        }

        pre {
            background-color: var(--code-bg);
            color: var(--code-text);
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            margin-bottom: 20px;
            border-left: 4px solid var(--primary-color);
        }

        pre code {
            background: none;
            color: inherit;
            padding: 0;
            font-size: 0.95em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background-color: var(--bg-alt);
        }

        .info-box {
            background-color: #dbeafe;
            border-left: 4px solid var(--primary-color);
            padding: 15px 20px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .warning-box {
            background-color: #fef3c7;
            border-left: 4px solid var(--accent-color);
            padding: 15px 20px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .danger-box {
            background-color: #fee2e2;
            border-left: 4px solid var(--danger-color);
            padding: 15px 20px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .success-box {
            background-color: #d1fae5;
            border-left: 4px solid var(--success-color);
            padding: 15px 20px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .file-list {
            background-color: var(--bg-alt);
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .file-list ul {
            margin-left: 0;
            list-style: none;
        }

        .file-list li {
            padding: 8px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .file-list li:last-child {
            border-bottom: none;
        }

        .file-list code {
            color: var(--primary-color);
            font-weight: 600;
        }

        .diagram {
            margin: 30px 0;
            text-align: center;
        }

        .diagram img {
            max-width: 100%;
            height: auto;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .diagram p {
            margin-top: 10px;
            font-style: italic;
            color: var(--text-secondary);
            text-align: center;
        }

        footer {
            background-color: var(--bg-alt);
            padding: 30px 40px;
            text-align: center;
            color: var(--text-secondary);
            border-top: 2px solid var(--border-color);
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-right: 8px;
        }

        .badge-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .badge-success {
            background-color: var(--success-color);
            color: white;
        }

        .badge-warning {
            background-color: var(--accent-color);
            color: white;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8rem;
            }

            nav ul {
                flex-direction: column;
                gap: 10px;
            }

            main {
                padding: 20px;
            }

            h2 {
                font-size: 1.5rem;
            }
        }

        .toc {
            background-color: var(--bg-alt);
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 30px;
        }

        .toc h3 {
            margin-top: 0;
            color: var(--primary-color);
        }

        .toc ul {
            margin-left: 20px;
        }

        .toc a {
            color: var(--text-primary);
            text-decoration: none;
        }

        .toc a:hover {
            color: var(--primary-color);
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>RH850/F1KM-S1 è©³ç´°è¨­è¨ˆæ›¸</h1>
            <p>ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã‚³ãƒ¼ãƒ‰ãƒ»å”èª¿å‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ© ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆä»•æ§˜</p>
        </header>

        <nav>
            <ul>
                <li><a href="#overview">æ¦‚è¦</a></li>
                <li><a href="#files">ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ</a></li>
                <li><a href="#memory">ãƒ¡ãƒ¢ãƒªãƒãƒƒãƒ—</a></li>
                <li><a href="#boot">èµ·å‹•ã‚·ãƒ¼ã‚±ãƒ³ã‚¹</a></li>
                <li><a href="#scheduler">ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©</a></li>
                <li><a href="#diagrams">å›³é¢</a></li>
                <li><a href="#build">ãƒ“ãƒ«ãƒ‰æ‰‹é †</a></li>
            </ul>
        </nav>

        <main>
            <!-- æ¦‚è¦ -->
            <section id="overview">
                <h2>ğŸ“‹ æ¦‚è¦</h2>
                <div class="info-box">
                    <p><strong>ç›®çš„:</strong> ãƒ–ãƒ¼ãƒˆã‹ã‚‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹ã¾ã§ã®å‹•ä½œã‚’æ˜ç¢ºåŒ–ã—ã€ç§»æ¤ãƒ»ä¿å®ˆãƒ»ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ”¯æ´ã™ã‚‹ã€‚</p>
                    <p><strong>å¯¾è±¡ãƒ‡ãƒã‚¤ã‚¹:</strong> Renesas RH850/F1KM-S1</p>
                </div>
                <p>ã“ã®æ–‡æ›¸ã¯ RH850/F1KM-S1 å‘ã‘ã«ä½œæˆã—ãŸã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ä¸€å¼ï¼ˆã‚¢ã‚»ãƒ³ãƒ–ãƒªã€ãƒªãƒ³ã‚«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ã€å”èª¿å‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã€ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªï¼‰ã«ã¤ã„ã¦ã®è©³ç´°è¨­è¨ˆã‚’ç¤ºã—ã¾ã™ã€‚</p>
            </section>

            <!-- ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ -->
            <section id="files">
                <h2>ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ</h2>
                <div class="file-list">
                    <ul>
                        <li><code>src/cstartup.asm</code> - ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ï¼ˆãƒªã‚»ãƒƒãƒˆãƒ™ã‚¯ã‚¿ã€BSSã‚¯ãƒªã‚¢ã€ãƒ‡ãƒ¼ã‚¿ã‚³ãƒ”ãƒ¼ã€SystemInit å‘¼ã³å‡ºã—ï¼‰</li>
                        <li><code>linker_script.ld</code> - ãƒ¡ãƒ¢ãƒªãƒãƒƒãƒ—ã¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³å‰²å½“</li>
                        <li><code>src/system_rh850.c</code> - ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ï¼ˆMainOSC/PLL/ã‚¯ãƒ­ãƒƒã‚¯åˆ†å‘¨ã€å‰²ã‚Šè¾¼ã¿åˆæœŸåŒ–ï¼‰</li>
                        <li><code>inc/system_rh850.h</code> - ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ã®ãƒ˜ãƒƒãƒ€</li>
                        <li><code>inc/rh850_regs.h</code> - ãƒ¬ã‚¸ã‚¹ã‚¿å®šç¾©ï¼ˆä¾‹: MOSC/PLL/INTCï¼‰</li>
                        <li><code>src/scheduler.c</code> - å”èª¿å‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©å®Ÿè£…ï¼ˆã‚¿ã‚¹ã‚¯ç®¡ç†ã€å‘¨æœŸå®Ÿè¡Œã€1msã‚¿ã‚¤ãƒãƒ¼é€£æºï¼‰</li>
                        <li><code>inc/scheduler.h</code> - ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©APIå®šç¾©</li>
                        <li><code>src/main.c</code> - ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªï¼ˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã«ã‚ˆã‚‹LEDç‚¹æ»…ã¨ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ï¼‰</li>
                    </ul>
                </div>
            </section>

            <!-- ãƒ¡ãƒ¢ãƒªãƒãƒƒãƒ— -->
            <section id="memory">
                <h2>ğŸ’¾ ãƒ¡ãƒ¢ãƒªãƒãƒƒãƒ—</h2>
                <table>
                    <thead>
                        <tr>
                            <th>é ˜åŸŸ</th>
                            <th>é–‹å§‹ã‚¢ãƒ‰ãƒ¬ã‚¹</th>
                            <th>çµ‚äº†ã‚¢ãƒ‰ãƒ¬ã‚¹</th>
                            <th>ã‚µã‚¤ã‚º</th>
                            <th>ç”¨é€”</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Code Flash</strong></td>
                            <td>0x0000_0000</td>
                            <td>0x001F_FFFF</td>
                            <td>2MB</td>
                            <td>ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚³ãƒ¼ãƒ‰</td>
                        </tr>
                        <tr>
                            <td><strong>Data Flash</strong></td>
                            <td>0x0100_0000</td>
                            <td>0x0100_FFFF</td>
                            <td>64KB</td>
                            <td>ãƒ‡ãƒ¼ã‚¿ä¿å­˜</td>
                        </tr>
                        <tr>
                            <td><strong>RAM</strong></td>
                            <td>0xFEDE_8000</td>
                            <td>0xFEE2_7FFF</td>
                            <td>256KB</td>
                            <td>ãƒ‡ãƒ¼ã‚¿ãƒ»ã‚¹ã‚¿ãƒƒã‚¯</td>
                        </tr>
                    </tbody>
                </table>

                <h3>ã‚¹ã‚¿ãƒƒã‚¯ãƒ»ãƒ’ãƒ¼ãƒ—è¨­å®š</h3>
                <ul>
                    <li><strong>ã‚¹ã‚¿ãƒƒã‚¯:</strong> 8KB (<code>__stack_size = 0x2000</code>)</li>
                    <li><strong>ãƒ’ãƒ¼ãƒ—:</strong> 16KB (<code>__heap_size = 0x4000</code>)</li>
                </ul>
            </section>

            <!-- èµ·å‹•ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ -->
            <section id="boot">
                <h2>ğŸš€ èµ·å‹•ã‚·ãƒ¼ã‚±ãƒ³ã‚¹</h2>
                <h3>èµ·å‹•ãƒ•ãƒ­ãƒ¼æ¦‚è¦</h3>
                <ol>
                    <li><strong>ãƒªã‚»ãƒƒãƒˆãƒ™ã‚¯ã‚¿</strong> - ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€/ROM ã«ã‚ˆã‚Šãƒªã‚»ãƒƒãƒˆãƒ™ã‚¯ã‚¿ã¸ã‚¸ãƒ£ãƒ³ãƒ—ï¼ˆ<code>_RESET</code>ï¼‰</li>
                    <li><strong>ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—å®Ÿè¡Œ</strong> - <code>cstartup.asm::_start</code> å®Ÿè¡Œ
                        <ul>
                            <li>å‰²ã‚Šè¾¼ã¿ç„¡åŠ¹åŒ– (<code>di</code>)</li>
                            <li>ã‚¹ã‚¿ãƒƒã‚¯ãƒã‚¤ãƒ³ã‚¿è¨­å®š (<code>SP_INIT = 0xFEE28000</code>)</li>
                            <li>BSSï¼ˆ<code>__sbss</code>ã€œ<code>__ebss</code>ï¼‰ã‚’ã‚¼ãƒ­ã‚¯ãƒªã‚¢</li>
                            <li>åˆæœŸåŒ–ãƒ‡ãƒ¼ã‚¿ï¼ˆROMä¸Šã® <code>__sdata_rom</code>ï¼‰ã‚’ RAM ã® <code>__sdata</code> ã¸ã‚³ãƒ”ãƒ¼</li>
                            <li><code>SystemInit()</code> ã‚’å‘¼ã³å‡ºã—</li>
                            <li>å‰²ã‚Šè¾¼ã¿æœ‰åŠ¹åŒ– (<code>ei</code>)</li>
                            <li><code>main()</code> ã¸åˆ†å²</li>
                        </ul>
                    </li>
                    <li><strong>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹</strong> - <code>main()</code> å®Ÿè¡Œ
                        <ul>
                            <li>GPIOåˆæœŸåŒ–ï¼ˆLEDåˆ¶å¾¡ç”¨ï¼‰</li>
                            <li>ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©åˆæœŸåŒ– (<code>Scheduler_Init()</code>)</li>
                            <li>ã‚¿ã‚¹ã‚¯ç™»éŒ²
                                <ul>
                                    <li>LEDç‚¹æ»…ã‚¿ã‚¹ã‚¯ï¼ˆ500mså‘¨æœŸï¼‰</li>
                                    <li>ã‚«ã‚¦ãƒ³ã‚¿æ›´æ–°ã‚¿ã‚¹ã‚¯ï¼ˆ500mså‘¨æœŸï¼‰</li>
                                </ul>
                            </li>
                            <li>ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©é–‹å§‹ (<code>Scheduler_Run()</code> - ç„¡é™ãƒ«ãƒ¼ãƒ—ã€å¾©å¸°ã—ãªã„)</li>
                        </ul>
                    </li>
                </ol>

                <h3>BSS ã¨ Data åˆæœŸåŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </h3>
                <div class="info-box">
                    <p><strong>BSS:</strong> <code>r6</code> ã‚’ <code>__sbss</code>ã€<code>r7</code> ã‚’ <code>__ebss</code> ã«ã—ã¦ãƒ¯ãƒ¼ãƒ‰å˜ä½ã§ 0 ã‚’æ›¸ãè¾¼ã‚€ã€‚ãƒ«ãƒ¼ãƒ—çµ‚äº†æ¡ä»¶ã¯ <code>r6 >= r7</code>ã€‚</p>
                    <p><strong>Data:</strong> <code>r6</code> ã‚’ã‚½ãƒ¼ã‚¹ <code>__sdata_rom</code>ã€<code>r7</code> ã‚’ãƒ‡ã‚¹ãƒ†ã‚£ãƒãƒ¼ã‚·ãƒ§ãƒ³ <code>__sdata</code>ã€<code>r8</code> ã‚’ <code>__edata</code> ã«ã—ã¦ãƒ¯ãƒ¼ãƒ‰ã‚³ãƒ”ãƒ¼ã€‚çµ‚äº†ã¯ <code>r7 >= r8</code>ã€‚</p>
                </div>
            </section>

            <!-- ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ© -->
            <section id="scheduler">
                <h2>âš™ï¸ ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è©³ç´°è¨­è¨ˆ</h2>
                
                <h3>ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦</h3>
                <p>å”èª¿å‹ï¼ˆnon-preemptiveï¼‰ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã‚’å®Ÿè£…ã€‚è¤‡æ•°ã®ã‚¿ã‚¹ã‚¯ã‚’å‘¨æœŸçš„ã«å®Ÿè¡Œã—ã€1msã‚¿ã‚¤ãƒãƒ¼å‰²ã‚Šè¾¼ã¿ã«ã‚ˆã‚‹æ™‚åˆ»ç®¡ç†ã‚’è¡Œã„ã¾ã™ã€‚</p>

                <h3>ä¸»è¦æ©Ÿèƒ½</h3>
                <ul>
                    <li><span class="badge badge-primary">ã‚¿ã‚¹ã‚¯ç®¡ç†</span> æœ€å¤§8å€‹ã®ã‚¿ã‚¹ã‚¯ã‚’ç™»éŒ²å¯èƒ½</li>
                    <li><span class="badge badge-success">å‘¨æœŸå®Ÿè¡Œ</span> å„ã‚¿ã‚¹ã‚¯ã«è¨­å®šã•ã‚ŒãŸå‘¨æœŸï¼ˆmså˜ä½ï¼‰ã§å®Ÿè¡Œ</li>
                    <li><span class="badge badge-warning">æ™‚åˆ»ç®¡ç†</span> 1msã‚¿ã‚¤ãƒãƒ¼å‰²ã‚Šè¾¼ã¿ã§ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚£ãƒƒã‚¯ã‚’ã‚«ã‚¦ãƒ³ãƒˆ</li>
                </ul>

                <h3>ãƒ‡ãƒ¼ã‚¿æ§‹é€ </h3>
                <h4>ã‚¿ã‚¹ã‚¯ç®¡ç†æ§‹é€ ä½“ (<code>task_t</code>)</h4>
                <pre><code>typedef struct {
  void (*func)(void);      // ã‚¿ã‚¹ã‚¯é–¢æ•°ãƒã‚¤ãƒ³ã‚¿
  uint32_t period_ms;      // å®Ÿè¡Œå‘¨æœŸï¼ˆãƒŸãƒªç§’ï¼‰
  uint32_t last_run_ms;    // æœ€çµ‚å®Ÿè¡Œæ™‚åˆ»ï¼ˆãƒŸãƒªç§’ï¼‰
  uint8_t used;            // ã‚¹ãƒ­ãƒƒãƒˆä½¿ç”¨ãƒ•ãƒ©ã‚°ï¼ˆ0: æœªä½¿ç”¨, 1: ä½¿ç”¨ä¸­ï¼‰
} task_t;</code></pre>

                <h4>å®šæ•°ãƒ»ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°</h4>
                <ul>
                    <li><code>MAX_TASKS</code>: 8ï¼ˆåŒæ™‚ç™»éŒ²å¯èƒ½ãªæœ€å¤§ã‚¿ã‚¹ã‚¯æ•°ï¼‰</li>
                    <li><code>s_tasks[MAX_TASKS]</code>: ã‚¿ã‚¹ã‚¯ç®¡ç†ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆstaticï¼‰</li>
                    <li><code>s_ticks_ms</code>: ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚£ãƒƒã‚¯ã‚«ã‚¦ãƒ³ã‚¿ï¼ˆ1mså˜ä½ã€volatileï¼‰</li>
                </ul>

                <h3>APIä»•æ§˜</h3>
                
                <h4><code>void Scheduler_Init(void)</code></h4>
                <div class="success-box">
                    <p><strong>ç›®çš„:</strong> ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã®åˆæœŸåŒ–</p>
                    <p><strong>å‡¦ç†å†…å®¹:</strong></p>
                    <ul>
                        <li>å…¨ã‚¿ã‚¹ã‚¯ã‚¹ãƒ­ãƒƒãƒˆã‚’ã‚¯ãƒªã‚¢ï¼ˆæœªä½¿ç”¨çŠ¶æ…‹ã«è¨­å®šï¼‰</li>
                        <li>ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚£ãƒƒã‚¯ã‚«ã‚¦ãƒ³ã‚¿ã‚’0ã«ãƒªã‚»ãƒƒãƒˆ</li>
                    </ul>
                    <p><strong>å‘¼ã³å‡ºã—ã‚¿ã‚¤ãƒŸãƒ³ã‚°:</strong> <code>main()</code> é–‹å§‹ç›´å¾Œã€ã‚¿ã‚¹ã‚¯ç™»éŒ²å‰</p>
                </div>

                <h4><code>int Scheduler_AddTask(void (*task)(void), uint32_t period_ms)</code></h4>
                <div class="success-box">
                    <p><strong>ç›®çš„:</strong> ã‚¿ã‚¹ã‚¯ã®ç™»éŒ²</p>
                    <p><strong>å¼•æ•°:</strong></p>
                    <ul>
                        <li><code>task</code>: å®Ÿè¡Œã™ã‚‹ã‚¿ã‚¹ã‚¯é–¢æ•°ã®ãƒã‚¤ãƒ³ã‚¿</li>
                        <li><code>period_ms</code>: ã‚¿ã‚¹ã‚¯ã®å®Ÿè¡Œå‘¨æœŸï¼ˆãƒŸãƒªç§’ï¼‰</li>
                    </ul>
                    <p><strong>æˆ»ã‚Šå€¤:</strong></p>
                    <ul>
                        <li><code>0</code>: ç™»éŒ²æˆåŠŸ</li>
                        <li><code>-1</code>: ç™»éŒ²å¤±æ•—ï¼ˆç©ºãã‚¹ãƒ­ãƒƒãƒˆãªã—ï¼‰</li>
                    </ul>
                </div>

                <h4><code>void Scheduler_Run(void)</code></h4>
                <div class="warning-box">
                    <p><strong>ç›®çš„:</strong> ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—ã®é–‹å§‹</p>
                    <p><strong>æ³¨æ„:</strong> ã“ã®é–¢æ•°ã¯å¾©å¸°ã—ã¾ã›ã‚“ï¼ˆç„¡é™ãƒ«ãƒ¼ãƒ—ï¼‰</p>
                    <p><strong>å‡¦ç†å†…å®¹:</strong></p>
                    <ul>
                        <li>ç„¡é™ãƒ«ãƒ¼ãƒ—ã§å…¨ã‚¿ã‚¹ã‚¯ã‚’ã‚¹ã‚­ãƒ£ãƒ³</li>
                        <li>ç¾åœ¨æ™‚åˆ»ï¼ˆ<code>s_ticks_ms</code>ï¼‰ã‚’å–å¾—</li>
                        <li>çµŒéæ™‚é–“ãŒå‘¨æœŸä»¥ä¸Šã®å ´åˆã€ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œ</li>
                        <li>1mså¾…æ©Ÿã—ã¦æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¸</li>
                    </ul>
                </div>

                <h4><code>void Scheduler_TickISR(void)</code></h4>
                <div class="info-box">
                    <p><strong>ç›®çš„:</strong> ã‚¿ã‚¤ãƒãƒ¼å‰²ã‚Šè¾¼ã¿ãƒãƒ³ãƒ‰ãƒ©ã‹ã‚‰å‘¼ã°ã‚Œã‚‹æ™‚åˆ»æ›´æ–°é–¢æ•°</p>
                    <p><strong>å‡¦ç†å†…å®¹:</strong> <code>s_ticks_ms</code> ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆï¼ˆ1msçµŒéï¼‰</p>
                    <p><strong>å‘¼ã³å‡ºã—ã‚¿ã‚¤ãƒŸãƒ³ã‚°:</strong> 1msã‚¿ã‚¤ãƒãƒ¼å‰²ã‚Šè¾¼ã¿ãƒãƒ³ãƒ‰ãƒ©å†…</p>
                </div>

                <h3>ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡</h3>
                <table>
                    <thead>
                        <tr>
                            <th>é …ç›®</th>
                            <th>ã‚µã‚¤ã‚º</th>
                            <th>èª¬æ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>s_tasks[8]</code></td>
                            <td>96ãƒã‚¤ãƒˆ</td>
                            <td>8 Ã— sizeof(task_t) = 8 Ã— 12ãƒã‚¤ãƒˆ</td>
                        </tr>
                        <tr>
                            <td><code>s_ticks_ms</code></td>
                            <td>4ãƒã‚¤ãƒˆ</td>
                            <td>uint32_t</td>
                        </tr>
                        <tr>
                            <td><strong>åˆè¨ˆï¼ˆRAMï¼‰</strong></td>
                            <td><strong>ç´„100ãƒã‚¤ãƒˆ</strong></td>
                            <td>é™çš„ç¢ºä¿</td>
                        </tr>
                        <tr>
                            <td>ã‚¹ã‚¿ãƒƒã‚¯ä½¿ç”¨é‡</td>
                            <td>ç´„16ã€œ50ãƒã‚¤ãƒˆ</td>
                            <td>ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•° + ã‚¿ã‚¹ã‚¯å‘¼ã³å‡ºã—</td>
                        </tr>
                    </tbody>
                </table>

                <h3>ã‚¿ã‚¤ãƒŸãƒ³ã‚°ç²¾åº¦</h3>
                <ul>
                    <li><strong>ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚£ãƒƒã‚¯ç²¾åº¦:</strong> 1ms</li>
                    <li><strong>ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼æ™‚é–“:</strong> 2<sup>32</sup> ms â‰ˆ 49.7æ—¥ï¼ˆå®Ÿç”¨ä¸Šååˆ†ï¼‰</li>
                    <li><strong>æœ€å°å®Ÿè¡Œå‘¨æœŸ:</strong> 1msï¼ˆã‚¿ã‚¹ã‚¯å‡¦ç†æ™‚é–“ãŒ1msæœªæº€ã§ã‚ã‚‹ã“ã¨ãŒå‰æï¼‰</li>
                    <li><strong>ã‚¸ãƒƒã‚¿ãƒ¼:</strong> Â±1msç¨‹åº¦ï¼ˆä»–ã‚¿ã‚¹ã‚¯ã®å‡¦ç†æ™‚é–“ã«ä¾å­˜ï¼‰</li>
                </ul>

                <h3>åˆ¶é™äº‹é …ã¨æ³¨æ„ç‚¹</h3>
                <div class="danger-box">
                    <ol>
                        <li><strong>å”èª¿å‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°:</strong> ã‚¿ã‚¹ã‚¯ã¯è‡ªç™ºçš„ã«CPUã‚’è­²ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚é•·æ™‚é–“å‡¦ç†ã‚’è¡Œã†ã‚¿ã‚¹ã‚¯ã¯ä»–ã®ã‚¿ã‚¹ã‚¯ã®å®Ÿè¡Œã‚’é…å»¶ã•ã›ã‚‹ã€‚</li>
                        <li><strong>å„ªå…ˆåº¦ãªã—:</strong> å…¨ã‚¿ã‚¹ã‚¯ã¯åŒç­‰ã«æ‰±ã‚ã‚Œã‚‹ã€‚ç·Šæ€¥ã‚¿ã‚¹ã‚¯ã®å„ªå…ˆå®Ÿè¡Œã¯ä¸å¯ã€‚</li>
                        <li><strong>ã‚¿ã‚¹ã‚¯æ•°åˆ¶é™:</strong> æœ€å¤§8å€‹ã¾ã§ã€‚è¿½åŠ ãŒå¿…è¦ãªå ´åˆã¯ <code>MAX_TASKS</code> ã‚’å¤‰æ›´ã€‚</li>
                        <li><strong>ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼:</strong> <code>s_ticks_ms</code> ã¯49.7æ—¥ã§ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã™ã‚‹ãŒã€å·®åˆ†è¨ˆç®—ã«ã‚ˆã‚Šæ­£å¸¸å‹•ä½œã€‚</li>
                        <li><strong>å†å…¥ä¸å¯:</strong> åŒä¸€ã‚¿ã‚¹ã‚¯ãŒå®Ÿè¡Œä¸­ã«å†åº¦å‘¼ã°ã‚Œã‚‹ã“ã¨ã¯ãªã„ãŒã€ã‚¿ã‚¹ã‚¯é–¢æ•°ã¯å†å…¥å¯èƒ½ã«å®Ÿè£…ã™ã¹ãã€‚</li>
                    </ol>
                </div>
            </section>

            <!-- å›³é¢ -->
            <section id="diagrams">
                <h2>ğŸ“Š è¨­è¨ˆå›³é¢</h2>
                
                <h3>ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³</h3>
                <div class="diagram">
                    <img src="diagrams/system_architecture.svg" alt="System Architecture">
                    <p>ã‚·ã‚¹ãƒ†ãƒ ã¯5å±¤ã§æ§‹æˆ: ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—å±¤ã€ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢å±¤ã€HAL/ãƒ‰ãƒ©ã‚¤ãƒå±¤ã€OS/ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢å±¤ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤</p>
                </div>

                <h3>ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ</h3>
                <div class="diagram">
                    <img src="diagrams/scheduler_flowchart.svg" alt="Scheduler Flowchart">
                    <p>ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã®åˆæœŸåŒ–ã‹ã‚‰ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—ã¾ã§ã®å‹•ä½œãƒ•ãƒ­ãƒ¼</p>
                </div>

                <h3>ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãƒãƒ£ãƒ¼ãƒˆ</h3>
                <div class="diagram">
                    <img src="diagrams/scheduler_timing.svg" alt="Scheduler Timing">
                    <p>Timer ISRã¨å„ã‚¿ã‚¹ã‚¯ã®å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼ˆ500mså‘¨æœŸï¼‰</p>
                </div>
            </section>

            <!-- SystemInit -->
            <section id="systeminit">
                <h2>ğŸ”§ SystemInit ã®è©³ç´°</h2>
                <p><code>system_rh850.c</code> ã«ãŠã‘ã‚‹åˆæœŸåŒ–å‡¦ç†:</p>
                <ul>
                    <li>MainOSC ã‚’æœ‰åŠ¹åŒ–ï¼ˆ<code>MOSCE = 0x01</code>ï¼‰ã—ã¦å®‰å®šåŒ–å¾…ã¡ï¼ˆãƒãƒ¼ãƒªãƒ³ã‚°ï¼‰</li>
                    <li>PLL ã‚’æœ‰åŠ¹åŒ– & å®‰å®šåŒ–å¾…ã¡ï¼ˆ<code>PLLC0</code>/<code>PLLS0</code>ï¼‰</li>
                    <li>CPU ã‚¯ãƒ­ãƒƒã‚¯ã€ãƒšãƒªãƒ•ã‚§ãƒ©ãƒ«ã‚¯ãƒ­ãƒƒã‚¯ã®åˆ†å‘¨ãƒ»åˆ‡æ›¿ï¼ˆ<code>CKSC</code> ç³»ãƒ¬ã‚¸ã‚¹ã‚¿ï¼‰</li>
                    <li>å‰²ã‚Šè¾¼ã¿ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ï¼ˆEICï¼‰ã‚’åˆæœŸåŒ–ã—ã¦å…¨ãƒãƒ£ãƒãƒ«ã‚’ãƒã‚¹ã‚¯ï¼‹æœ€ä½å„ªå…ˆåº¦ã«è¨­å®š</li>
                    <li>ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•° <code>g_system_clock</code>, <code>g_peripheral_clock</code> ã‚’è¨­å®š</li>
                </ul>

                <div class="warning-box">
                    <p><strong>æ³¨æ„:</strong> ãƒ¬ã‚¸ã‚¹ã‚¿æ›¸ãè¾¼ã¿ãŒä¿è­·ã•ã‚Œã¦ã„ã‚‹é ˜åŸŸã®å ´åˆã¯ãƒ—ãƒ­ãƒ†ã‚¯ã‚·ãƒ§ãƒ³è§£é™¤æ‰‹é †ã‚’è¸ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
                </div>

                <h3>ä¸»è¦ãƒ¬ã‚¸ã‚¹ã‚¿ã¨ã‚¢ãƒ‰ãƒ¬ã‚¹</h3>
                <table>
                    <thead>
                        <tr>
                            <th>ãƒ¬ã‚¸ã‚¹ã‚¿</th>
                            <th>ã‚¢ãƒ‰ãƒ¬ã‚¹</th>
                            <th>ç”¨é€”</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>MOSCE</code></td>
                            <td>0xFFF81100</td>
                            <td>MainOSC æœ‰åŠ¹åŒ–</td>
                        </tr>
                        <tr>
                            <td><code>MOSCS</code></td>
                            <td>0xFFF81104</td>
                            <td>MainOSC ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</td>
                        </tr>
                        <tr>
                            <td><code>PLLC0</code></td>
                            <td>0xFFF89000</td>
                            <td>PLL åˆ¶å¾¡</td>
                        </tr>
                        <tr>
                            <td><code>PLLS0</code></td>
                            <td>0xFFF89004</td>
                            <td>PLL ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</td>
                        </tr>
                        <tr>
                            <td><code>INTC1_BASE</code></td>
                            <td>0xFFFC0000</td>
                            <td>å‰²ã‚Šè¾¼ã¿ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ï¼ˆEIC é…åˆ—ï¼‰</td>
                        </tr>
                        <tr>
                            <td><code>PORT0</code></td>
                            <td>0xFFC10000</td>
                            <td>GPIO Port 0</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- ãƒ“ãƒ«ãƒ‰æ‰‹é † -->
            <section id="build">
                <h2>ğŸ”¨ ãƒ“ãƒ«ãƒ‰æ‰‹é †</h2>
                <h3>å¿…è¦ãªãƒ„ãƒ¼ãƒ«</h3>
                <ul>
                    <li>Renesas CS+ for CC ã¾ãŸã¯ GHS MULTI (Green Hills Software)</li>
                    <li>RH850ç”¨GCCãƒ„ãƒ¼ãƒ«ãƒã‚§ãƒ¼ãƒ³ï¼ˆã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ç‰ˆä½¿ç”¨æ™‚ï¼‰</li>
                </ul>

                <h3>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ä¾‹ï¼ˆGCCã®å ´åˆï¼‰</h3>
                <pre><code># ã‚¢ã‚»ãƒ³ãƒ–ãƒ«
rh850-elf-as -mcpu=g3m -o cstartup.o src/cstartup.asm

# ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
rh850-elf-gcc -mcpu=g3m -O2 -I inc -c src/system_rh850.c -o system_rh850.o
rh850-elf-gcc -mcpu=g3m -O2 -I inc -c src/scheduler.c -o scheduler.o
rh850-elf-gcc -mcpu=g3m -O2 -I inc -c src/main.c -o main.o

# ãƒªãƒ³ã‚¯
rh850-elf-ld -T linker_script.ld cstartup.o system_rh850.o scheduler.o main.o -o firmware.elf

# HEX ç”Ÿæˆ
rh850-elf-objcopy -O ihex firmware.elf firmware.hex</code></pre>

                <h3>æ¤œè¨¼/ãƒ‡ãƒãƒƒã‚°æ‰‹é †</h3>
                <ul>
                    <li>JTAG/ãƒ‡ãƒãƒƒã‚¬ã§ RAM ã¨ ROM ã«æ­£ã—ã„ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æ›¸ãè¾¼ã¿ã€ãƒªã‚»ãƒƒãƒˆå¾Œã« <code>main</code> ã«åˆ°é”ã™ã‚‹ã‹ç¢ºèª</li>
                    <li>BSS ã‚»ã‚¯ã‚·ãƒ§ãƒ³é–‹å§‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨çµ‚äº†ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ­£ã—ã„ã‹ç¢ºèªï¼ˆæœªåˆæœŸåŒ–å¤‰æ•°ãŒ 0 ã«ãªã‚‹ã‹ï¼‰</li>
                    <li>Data ã‚³ãƒ”ãƒ¼å…ƒã‚¢ãƒ‰ãƒ¬ã‚¹ (<code>__sdata_rom</code>) ãŒãƒªãƒ³ã‚«ã§æœŸå¾…ã—ãŸ ROM ä¸Šã®ä½ç½®ã«ãªã£ã¦ã„ã‚‹ã‹ã‚’æ¤œè¨¼</li>
                    <li>ã‚¯ãƒ­ãƒƒã‚¯è¨­å®šå¾Œã« <code>SystemGetCpuClock()</code> ã®è¿”ã‚Šå€¤ãŒæœŸå¾…å€¤ã‹ç¢ºèª</li>
                </ul>

                <h3>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ–¹æ³•</h3>
                <div class="info-box">
                    <ul>
                        <li><strong>ã‚¹ã‚¿ãƒƒã‚¯ã‚µã‚¤ã‚ºå¤‰æ›´:</strong> <code>linker_script.ld</code> ã® <code>__stack_size</code> ã‚’æ›´æ–°</li>
                        <li><strong>ã‚¯ãƒ­ãƒƒã‚¯è¨­å®šå¤‰æ›´:</strong> <code>system_rh850.c</code> ã® <code>PLL_MUL</code>, <code>CPU_DIV</code>, <code>PERIPHERAL_DIV</code> ã‚’æ›´æ–°</li>
                        <li><strong>ã‚¿ã‚¹ã‚¯æ•°å¤‰æ›´:</strong> <code>scheduler.c</code> ã® <code>MAX_TASKS</code> ã‚’æ›´æ–°</li>
                        <li><strong>ãƒ™ã‚¯ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«æ‹¡å¼µ:</strong> <code>cstartup.asm</code> ã® <code>__exception_table</code> ã«å„ãƒãƒ³ãƒ‰ãƒ©ãƒ©ãƒ™ãƒ«ã‚’è¿½åŠ </li>
                    </ul>
                </div>
            </section>

            <!-- å¤‰æ›´å±¥æ­´ -->
            <section id="changelog">
                <h2>ğŸ“ å¤‰æ›´å±¥æ­´</h2>
                <table>
                    <thead>
                        <tr>
                            <th>æ—¥ä»˜</th>
                            <th>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</th>
                            <th>å¤‰æ›´å†…å®¹</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2025-11-16</td>
                            <td>1.0</td>
                            <td>åˆç‰ˆä½œæˆï¼ˆã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—ã‚¢ã‚»ãƒ³ãƒ–ãƒªã€ãƒªãƒ³ã‚«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€system initã€ã‚µãƒ³ãƒ—ãƒ« main ã‚’åæ˜ ï¼‰</td>
                        </tr>
                        <tr>
                            <td>2025-11-17</td>
                            <td>1.1</td>
                            <td>ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¿½åŠ ï¼ˆå”èª¿å‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã€ã‚¿ã‚¹ã‚¯ç®¡ç†ã€1msã‚¿ã‚¤ãƒãƒ¼é€£æºã®è©³ç´°è¨­è¨ˆã‚’è¿½åŠ ï¼‰</td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </main>

        <footer>
            <p>&copy; 2025 RH850/F1KM-S1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ | è©³ç´°è¨­è¨ˆæ›¸ v1.1</p>
            <p>ä½œæˆæ—¥: 2025å¹´11æœˆ17æ—¥ | å¯¾è±¡ãƒ‡ãƒã‚¤ã‚¹: Renesas RH850/F1KM-S1</p>
        </footer>
    </div>
</body>
</html>