<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 700">
  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" font-size="22" font-weight="bold" fill="#333">RH850/F1KM-S1 システムアーキテクチャ</text>
  
  <!-- Hardware Layer -->
  <rect x="50" y="60" width="800" height="120" fill="#FFEBEE" stroke="#D32F2F" stroke-width="2" rx="5"/>
  <text x="70" y="85" font-size="16" font-weight="bold" fill="#D32F2F">ハードウェア層</text>
  
  <!-- RH850 CPU -->
  <rect x="80" y="100" width="150" height="60" fill="#EF5350" stroke="#C62828" stroke-width="2" rx="3"/>
  <text x="155" y="125" text-anchor="middle" font-size="13" font-weight="bold" fill="white">RH850/F1KM-S1</text>
  <text x="155" y="143" text-anchor="middle" font-size="11" fill="white">CPU: 120MHz</text>
  <text x="155" y="157" text-anchor="middle" font-size="11" fill="white">RAM: 256KB</text>
  
  <!-- Timer -->
  <rect x="260" y="100" width="120" height="60" fill="#EF5350" stroke="#C62828" stroke-width="2" rx="3"/>
  <text x="320" y="125" text-anchor="middle" font-size="13" font-weight="bold" fill="white">タイマー</text>
  <text x="320" y="143" text-anchor="middle" font-size="11" fill="white">1ms割り込み</text>
  
  <!-- GPIO -->
  <rect x="410" y="100" width="120" height="60" fill="#EF5350" stroke="#C62828" stroke-width="2" rx="3"/>
  <text x="470" y="125" text-anchor="middle" font-size="13" font-weight="bold" fill="white">GPIO</text>
  <text x="470" y="143" text-anchor="middle" font-size="11" fill="white">Port 0 (LED)</text>
  
  <!-- Peripheral -->
  <rect x="560" y="100" width="120" height="60" fill="#EF5350" stroke="#C62828" stroke-width="2" rx="3"/>
  <text x="620" y="125" text-anchor="middle" font-size="13" font-weight="bold" fill="white">周辺機器</text>
  <text x="620" y="143" text-anchor="middle" font-size="11" fill="white">I2C, SPI等</text>
  
  <!-- Memory -->
  <rect x="710" y="100" width="120" height="60" fill="#EF5350" stroke="#C62828" stroke-width="2" rx="3"/>
  <text x="770" y="125" text-anchor="middle" font-size="13" font-weight="bold" fill="white">Flash/RAM</text>
  <text x="770" y="143" text-anchor="middle" font-size="11" fill="white">Code: 2MB</text>
  
  <!-- HAL Layer -->
  <rect x="50" y="210" width="800" height="100" fill="#E3F2FD" stroke="#1976D2" stroke-width="2" rx="5"/>
  <text x="70" y="235" font-size="16" font-weight="bold" fill="#1976D2">HAL/ドライバ層</text>
  
  <!-- System Init -->
  <rect x="80" y="250" width="150" height="50" fill="#42A5F5" stroke="#1565C0" stroke-width="2" rx="3"/>
  <text x="155" y="270" text-anchor="middle" font-size="12" font-weight="bold" fill="white">system_rh850.c</text>
  <text x="155" y="287" text-anchor="middle" font-size="10" fill="white">クロック・割り込み初期化</text>
  
  <!-- Timer Driver -->
  <rect x="260" y="250" width="120" height="50" fill="#42A5F5" stroke="#1565C0" stroke-width="2" rx="3"/>
  <text x="320" y="270" text-anchor="middle" font-size="12" font-weight="bold" fill="white">Timer ISR</text>
  <text x="320" y="287" text-anchor="middle" font-size="10" fill="white">TickISR呼び出し</text>
  
  <!-- GPIO Driver -->
  <rect x="410" y="250" width="120" height="50" fill="#42A5F5" stroke="#1565C0" stroke-width="2" rx="3"/>
  <text x="470" y="270" text-anchor="middle" font-size="12" font-weight="bold" fill="white">GPIO制御</text>
  <text x="470" y="287" text-anchor="middle" font-size="10" fill="white">Port操作関数</text>
  
  <!-- Register Defs -->
  <rect x="560" y="250" width="270" height="50" fill="#42A5F5" stroke="#1565C0" stroke-width="2" rx="3"/>
  <text x="695" y="270" text-anchor="middle" font-size="12" font-weight="bold" fill="white">rh850_regs.h</text>
  <text x="695" y="287" text-anchor="middle" font-size="10" fill="white">レジスタ定義・アドレスマップ</text>
  
  <!-- OS/Middleware Layer -->
  <rect x="50" y="340" width="800" height="100" fill="#E8F5E9" stroke="#388E3C" stroke-width="2" rx="5"/>
  <text x="70" y="365" font-size="16" font-weight="bold" fill="#388E3C">OS/ミドルウェア層</text>
  
  <!-- Scheduler -->
  <rect x="150" y="380" width="200" height="50" fill="#66BB6A" stroke="#2E7D32" stroke-width="2" rx="3"/>
  <text x="250" y="400" text-anchor="middle" font-size="13" font-weight="bold" fill="white">scheduler.c</text>
  <text x="250" y="417" text-anchor="middle" font-size="11" fill="white">協調型スケジューラ (8タスク)</text>
  
  <!-- Future modules -->
  <rect x="380" y="380" width="150" height="50" fill="#A5D6A7" stroke="#66BB6A" stroke-width="1" stroke-dasharray="5,5" rx="3"/>
  <text x="455" y="400" text-anchor="middle" font-size="12" fill="#333">(将来拡張)</text>
  <text x="455" y="417" text-anchor="middle" font-size="10" fill="#666">通信ミドルウェア</text>
  
  <rect x="560" y="380" width="150" height="50" fill="#A5D6A7" stroke="#66BB6A" stroke-width="1" stroke-dasharray="5,5" rx="3"/>
  <text x="635" y="400" text-anchor="middle" font-size="12" fill="#333">(将来拡張)</text>
  <text x="635" y="417" text-anchor="middle" font-size="10" fill="#666">診断モジュール</text>
  
  <!-- Application Layer -->
  <rect x="50" y="470" width="800" height="100" fill="#FFF3E0" stroke="#F57C00" stroke-width="2" rx="5"/>
  <text x="70" y="495" font-size="16" font-weight="bold" fill="#F57C00">アプリケーション層</text>
  
  <!-- Main -->
  <rect x="120" y="510" width="120" height="50" fill="#FFB74D" stroke="#E65100" stroke-width="2" rx="3"/>
  <text x="180" y="530" text-anchor="middle" font-size="13" font-weight="bold" fill="white">main.c</text>
  <text x="180" y="547" text-anchor="middle" font-size="10" fill="white">エントリーポイント</text>
  
  <!-- LED Task -->
  <rect x="270" y="510" width="120" height="50" fill="#FFB74D" stroke="#E65100" stroke-width="2" rx="3"/>
  <text x="330" y="530" text-anchor="middle" font-size="13" font-weight="bold" fill="white">LED Task</text>
  <text x="330" y="547" text-anchor="middle" font-size="10" fill="white">500ms周期</text>
  
  <!-- Counter Task -->
  <rect x="420" y="510" width="120" height="50" fill="#FFB74D" stroke="#E65100" stroke-width="2" rx="3"/>
  <text x="480" y="530" text-anchor="middle" font-size="13" font-weight="bold" fill="white">Counter Task</text>
  <text x="480" y="547" text-anchor="middle" font-size="10" fill="white">500ms周期</text>
  
  <!-- Future tasks -->
  <rect x="570" y="510" width="250" height="50" fill="#FFCC80" stroke="#F57C00" stroke-width="1" stroke-dasharray="5,5" rx="3"/>
  <text x="695" y="530" text-anchor="middle" font-size="12" fill="#333">(ユーザー定義タスク)</text>
  <text x="695" y="547" text-anchor="middle" font-size="10" fill="#666">最大8個まで登録可能</text>
  
  <!-- Startup/Boot -->
  <rect x="50" y="600" width="800" height="80" fill="#F3E5F5" stroke="#7B1FA2" stroke-width="2" rx="5"/>
  <text x="70" y="625" font-size="16" font-weight="bold" fill="#7B1FA2">スタートアップ層</text>
  
  <!-- cstartup -->
  <rect x="100" y="640" width="180" height="30" fill="#AB47BC" stroke="#4A148C" stroke-width="2" rx="3"/>
  <text x="190" y="660" text-anchor="middle" font-size="12" font-weight="bold" fill="white">cstartup.asm</text>
  
  <!-- Linker Script -->
  <rect x="310" y="640" width="180" height="30" fill="#AB47BC" stroke="#4A148C" stroke-width="2" rx="3"/>
  <text x="400" y="660" text-anchor="middle" font-size="12" font-weight="bold" fill="white">linker_script.ld</text>
  
  <!-- Boot Flow -->
  <rect x="520" y="640" width="310" height="30" fill="#CE93D8" stroke="#7B1FA2" stroke-width="1" rx="3"/>
  <text x="675" y="660" text-anchor="middle" font-size="11" fill="#333">リセット→BSS/Dataコピー→SystemInit→main</text>
  
  <!-- Arrows showing data flow -->
  <!-- Timer to Scheduler -->
  <path d="M 320 300 L 250 380" stroke="#FF5722" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="300" y="340" font-size="10" fill="#FF5722" font-weight="bold">TickISR</text>
  
  <!-- Scheduler to Tasks -->
  <path d="M 250 430 L 250 510" stroke="#4CAF50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M 250 430 L 330 510" stroke="#4CAF50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M 250 430 L 480 510" stroke="#4CAF50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Tasks to GPIO -->
  <path d="M 330 510 L 470 300" stroke="#2196F3" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Startup to System Init -->
  <path d="M 190 640 L 155 300" stroke="#9C27B0" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333"/>
    </marker>
  </defs>
</svg>
